(function(n){app.modals.CreateOrEditSalesOrderModal=function(){function e(){n(".subcat-set").each(function(){var t=n(this).index();n(":input",this).each(function(){this.name=this.name.replace(/[0-9]+/,t);this.id=this.id.replace(/[0-9]+/,t)});n(this).find(".field-validation-valid, .field-validation-error").each(function(){var r=n(this).attr("data-valmsg-for"),i=n(this).attr("data-valmsg-for").replace(/[0-9]+/,t);n(this).attr("data-valmsg-for",i)})})}var u=abp.services.app.salesOrders,i,t=null,f=new app.ModalManager({viewUrl:abp.appPath+"Portal/SalesOrders/CustomerLookupTableModal",scriptUrl:abp.appPath+"view-resources/Areas/Portal/Views/SalesOrders/_SalesOrderCustomerLookupTableModal.js",modalClass:"CustomerLookupTableModal"}),r;this.init=function(n){var r,u,f;i=n;r=i.getModal();alert(abp.localization.currentLanguage.name);r.find(".date-picker").datetimepicker({locale:abp.localization.currentLanguage.name,format:"L"});u=new Date;f=u.getDate()+"/0"+(u.getMonth()+1)+"/"+u.getFullYear();r.find(".date-picker").val(f);r.find("#CustomerId").select2({width:"100%"});t=i.getModal().find("form[name=SalesOrderInformationsForm]");t.validate();r.find(".modal-dialog").addClass("modal-xxl")};n("#OpenCustomerLookupTableButton").click(function(){var n=t.serializeFormToObject();f.open({id:n.customerId,displayName:n.customerName},function(n){t.find("input[name=customerName]").val(n.displayName);t.find("input[name=customerId]").val(n.id)})});n("#ClearCustomerNameButton").click(function(){t.find("input[name=customerName]").val("");t.find("input[name=customerId]").val("")});r=n(".subcat-sets");n("#AddOrderLineButton").click(function(t){t.preventDefault();var i=n(".subcat-set:last-child").clone(!0);i.show();r.append(i);e()});this.save=function(){if(t.valid()){if(n("#SalesOrder_CustomerId").prop("required")&&n("#SalesOrder_CustomerId").val()==""){abp.message.error(app.localize("{0}IsRequired",app.localize("Customer")));return}var r=t.toObject({mode:"first"});i.setBusy(!0);u.createOrEdit(r).done(function(){abp.notify.info(app.localize("SavedSuccessfully"));i.close();abp.event.trigger("app.createOrEditSalesOrderModalSaved")}).always(function(){i.setBusy(!1)})}}}})(jQuery);